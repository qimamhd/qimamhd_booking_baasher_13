<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <data>
      

        <record model="ir.ui.view" id="hotel_master_view">
            <field name="name">hotel.master.view</field>
            <field name="model">hotel.master</field>
            <field name="type">form</field>
            <field name="arch" type="xml">
                    <form>
                        <header>
                            <button name="confirm_btn" string="اعتماد" type="object" class="oe_highlight"
                                 attrs="{'invisible':[ ('state','!=', 'initial_booking')]}"
                                 />
                            <button name="un_confirm_btn" string="الغاء الاعتماد" type="object" class="oe_highlight"
                                 attrs="{'invisible':[ ('state','!=', 'booking_done')]}"
                                     
                                 />
                            <button name="create_invoice" string="انشاء فاتورة" type="object" class="oe_highlight"
                                        groups="qimamhd_booking_13.group_create_invoice_booking"
                                 attrs="{'invisible':['|',('create_invoice_manually_id','!=', False),('state','!=', 'booking_done')]}"
                            />
                            <button name="complete_btn" string="انتهاء الحجز" type="object" class="oe_highlight"
                                 attrs="{'invisible':['|',('create_invoice_manually_id','=', False),('state','not in', ['booking_done'])]}"
                                  groups="qimamhd_booking_13.group_create_invoice_booking"
                                 />
                            <button name="cancel_booking" string="الغاء الحجز" type="object" class="oe_highlight"
                                 attrs="{'invisible':[('state','in', ['initial_booking'])]}"
                                 groups="qimamhd_booking_13.group_allow_cancel_wo"
                                 />
                            <button name="register_payment"  string="تسجيل دفعة"   type="object" class="oe_highlight"
                                groups="qimamhd_booking_13.group_register_payment"
                                 attrs="{'invisible':[('state','in',['cancel_booking'])]}"
                                  />
                            <field name="state" widget="statusbar" statusbar_visible="initial_booking,booking_done,finish_booking,cancel_booking"/>
                        </header>
                        <sheet>
                            <div class="oe_button_box" name="button_box">
                                <button type="object"
                                     name="action_register_payment"
                                     class="oe_stat_button"
                                     string="الدفعات المقدمة"
                                      attrs="{'invisible':[('lines_payment','=', False)]}"
                                      groups="qimamhd_booking_13.group_register_payment"
                                      icon="fa-history" >
                                     
 
                             </button>
                            <button type="object"
                                     name="call_extend_services"
                                     class="oe_stat_button"
                                     string="الخدمات الملحقة"
                                      attrs="{'invisible':[('service_extend_lines','=', False)]}"
                                    
                                      icon="fa-history" >
                                     
 
                             </button>
                               
                               <button name="call_invoice" string="فاتورة المبيعات" type="object" class="oe_highlight"
                                 attrs="{'invisible':[('create_invoice_manually_id','=', False)]}"
                                       icon="fa-pencil-square-o"
                                 />
 
                                
                                
 
                          </div>
                            <group>
                                <field name="create_invoice_manually_id" invisible="1" />
                                <field name="service_extend_lines" invisible="1" />
                                <group>
                                    <field name="id" readonly="1"  string="رقم العقد"/>
                                    <field name="service_id"  options="{'no_quick_create':True,'no_create_edit':True,'no_open': True,'no_create': True}"  attrs="{'readonly':[('state','not in',['initial_booking'])]}"/>
                                    <field name="booking_start_date" attrs="{'readonly':[('state','not in',['initial_booking'])]}"/>
                                    <field name="booking_end_date" attrs="{'readonly':[('state','not in',['initial_booking'])]}"/>
                                    <field name="desc" attrs="{'readonly':[('state','not in',['initial_booking'])]}" />
                                </group>
                               <group>
                                    <field name="seq" readonly="1"  string="الرقم التسلسلي للفرع"/>
                                    <field name="order_date" attrs="{'readonly':[('state','not in',['initial_booking'])]}"/>
                                    <field name="order_from_higri_date" placeholder="yyyy-mm-dd"   attrs="{'readonly':[('state','not in',['initial_booking'])]}" />
                                    <field name="order_to_higri_date" placeholder="yyyy-mm-dd"   attrs="{'readonly':[('state','not in',['initial_booking'])]}" />
                                    <field name="booking_day" attrs="{'readonly':[('state','not in',['initial_booking'])]}"/>
                                    <field name="booking_night" attrs="{'readonly':[('state','not in',['initial_booking'])]}"/>
                               </group>
                               <group>
                                    <field name="partner_id" attrs="{'readonly':[('state','not in',['initial_booking'])]}"/>
                                    <field name="partner_nationality" attrs="{'readonly':[('state','not in',['initial_booking'])]}"/>
                                    <field name="partner_mobile1" attrs="{'readonly':[('state','not in',['initial_booking'])]}"/>
                                    <field name="partner_mobile2" attrs="{'readonly':[('state','not in',['initial_booking'])]}"/>
                               </group>
                               <group>
                                    <field name="partner_identifier" attrs="{'readonly':[('state','not in',['initial_booking'])]}"/>
                                    <field name="partner_identifier_source" attrs="{'readonly':[('state','not in',['initial_booking'])]}"/>
                                    <field name="partner_identifier_date" attrs="{'readonly':[('state','not in',['initial_booking'])]}"/>
                               </group>
                            </group>
                            <notebook>
                                <page string="الحجز">
                                    <group>
                                        <group>
                                        <field name="department_id"  options="{'no_quick_create':True,'no_create_edit':True,'no_open': True,'no_create': True}" attrs="{'readonly':[('state','not in',['initial_booking'])]}"/>
                                        <field name="department_price"  attrs="{'readonly':[('state','not in',['initial_booking'])]}"/>
                                        <field name="dept_tax_ids"  options="{'no_quick_create':True,'no_create_edit':True,'no_open': True,'no_create': True}" readonly="1" force_save="1" />
                                        <field name="dept_after_discount_with_tax"  />

                                        </group>
                                        <group>
                                            <field name="dept_discount_type"  attrs="{'readonly':[('state','not in',['initial_booking'])]}"/>
                                            <field name="dept_discount" attrs="{'readonly':[('state','not in',['initial_booking'])]}" />
                                         
                                            <field name="dept_discount_total"  />
                                            <field name="dept_discount_perc"  />

                                        </group>
                                    </group>
                                    
                                    <group>
                                        <field name="lines" attrs="{'readonly':[('state','not in',['initial_booking'])]}" nolabel="1" >
                                            <tree editable="bottom" >
                                                <field name="product_id"  options="{'no_quick_create':True,'no_create_edit':True,'no_open': True,'no_create': True}"/>
                                                <field name="person_count" />
                                                <field name="delivered_qty" />
                                                <field name="header_id" invisible="1"/>
                                            </tree>
                                        </field>
                                    </group>
                                </page>
                                <page string="خدمات القاعات">
                                    <group>
                                        <field name="service_lines" attrs="{'readonly':[('state','not in',['initial_booking'])]}" nolabel="1" >
                                            <tree editable="bottom" >
                                                <field name="product_id"  context="{'default_type':'service','default_booking_flag': True}" options="{ 'no_create_edit':True,'no_open': True, }"/>
                                                <field name="name" />
                                                <field name="qty" sum="الاجمالي" />
                                                <field name="price" />

                                                <field name="tax_ids" />
                                                <field name="total" />
                                                <field name="discount_type" />
                                                <field name="discount" />
                                                <field name="discount_total" />
                                                <field name="base_amount" />
                                                <field name="price_after_discount" />
                                                <field name="price_after_discount_with_tax" sum="الاجمالي"/>
                                                <field name="header_id" invisible="1"/>
                                            </tree>
                                        </field>
                                    </group>
                                    <button name="action_extend_services"  string="اضافة خدمات ملحقة للحجز"   type="object" class="oe_highlight"
                                         attrs="{'invisible':[('create_invoice_manually_id','!=', False)]}"
                                     />
                                </page>
                                <page string="المدفوعات"  groups="qimamhd_booking_13.group_register_payment">
                                    <group>
                                        <field name="advance_amount" />
                                        <field name="remaining_amount" />

                                    </group>
                                    <field name="lines_payment"  readonly="1" nolabel="1">
                                         <tree editable="bottom" >

                                           <field name="id" readonly="1" string="رقم الدفع" />
                                         <field name="pay_date" string="تاريخ الدفع" attrs="{'readonly': [('state','=','posted')]}"/>
                                          <field name="journal_id" string="طريقة الدفع"   attrs="{'readonly': [('state','=','posted')]}" options="{'no_quick_create':True,'no_create_edit':True,'no_open': True,'no_create': True}"/>

                                          <field name="payment_amount" sum="الاجمالي" attrs="{'readonly': [('state','=','posted')]}" required="1" string="المبلغ المدفرع" />
                                              <field name="payment_note"  attrs="{'readonly': [('state','=','posted')]}" string="البيانات"/>
                                            <field name="state" readonly="1" string="الحالة"/>

                                         </tree>
                                     </field>
                               </page>
                                <page string="بيانات اخرى">
                                    <group>
                                        <field name="finish_booking_date"  readonly="1" force_save="1"/>
                                        <field name="user_id"  attrs="{'readonly':[('state','not in',['initial_booking'])]}"  options="{'no_quick_create':True,'no_create_edit':True,'no_open': True,'no_create': True}"/>
                                    </group>
                                    <group>
                                        <field name="branch_id"   options="{'no_quick_create':True,'no_create_edit':True,'no_open': True,'no_create': True}" />
                                        <field name="company_id" string="الشركة"  options="{'no_quick_create':True,'no_create_edit':True,'no_open': True,'no_create': True}" groups="base.group_multi_company"/>
                                    </group>
                                </page>
                            </notebook>
                            <group string="الاجمالي">
                                <group>
                                       <field name="service_price" force_save="1" />
                                </group>
                                <group>
                                      <field name="service_price_after_discount" force_save="1" />
                                </group>
                                    <group> 
                                        <field name="service_discount_perc" force_save="1"  readonly="1"/> 
                                        <field name="service_discount_total" force_save="1"  readonly="1"/> 
                                     </group>
                                 <group>
                                        <field name="service_after_discount_with_tax" force_save="1" />
                                 </group>
   
   
                                <group string="الخصم من الاجمالي"   >
                                   <field name="discount_type" force_save="1"  attrs="{'readonly':[('state','not in',['initial_booking'])]}"/>
                                  <field name="discount"  force_save="1" attrs="{'readonly':[('state','not in',['initial_booking'])]}"/>
                               </group>
                            </group>
                        </sheet>
                        <div class="oe_chatter">
                            <field name="message_follower_ids" widget="mail_followers"/>
   <!--                        <field name="activity_ids" widget="mail_activity"/>-->
                           <field name="message_ids" widget="mail_thread"/>
                       </div>
                    </form>
            </field>
        </record>

        <record id="hotel_master_tree_view" model="ir.ui.view">
            <field name="name">hotel.master.tree</field>
            <field name="model">hotel.master</field>
            <field name="arch" type="xml">
                <tree>
                 
                    <field name="seq" readonly="1"  string="الرقم التسلسلي للفرع"/>
                    <field name="partner_id" />
                               
                    <field name="desc" />
                    <field name="booking_start_date" />
                    <field name="booking_end_date" />
                    <field name="finish_booking_date" />

                    <field name="branch_id"    options="{'no_create': True}" />
                    <field name="company_id" string="الشركة"  options="{'no_create': True}" groups="base.group_multi_company"/>

                    

                </tree>
            </field>
        </record>
        <record id="hotel_master_view_calendar" model="ir.ui.view">
            <field name="name">hotel_master.view.calendar</field>
            <field name="model">hotel.master</field>
            <field name="arch" type="xml">
                <calendar string="الحجز" date_start="booking_start_date" date_stop="booking_end_date"  mode="month" quick_add="False"
               
                     color="state">
                    <field name="partner_id" />
                    <field name="desc" />
                    <field name="booking_start_date" />
                    <field name="booking_end_date" />
                    <field name="state" />

                </calendar>
            </field>
        </record>
        <record id="action_hotel_master_view" model="ir.actions.act_window">
            <field name="name">حجوزات العملاء</field>
            <field name="res_model">hotel.master</field>
            <field name="type">ir.actions.act_window</field>
            <field name="view_mode">calendar,tree,form</field>
            <field name="view_id" ref="hotel_master_view_calendar"/>
            <field name="target">current</field>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">Click to create new service Type
                </p>
            </field>
        </record>



        <menuitem id="booking_menu" name="الحجوزات" parent="hotel_operation_menu" sequence="1"
            action="action_hotel_master_view" />

    </data>
</odoo>